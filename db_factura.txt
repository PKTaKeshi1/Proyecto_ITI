CREATE TABLE `mae_usuario` (
  `id_usuario` int(11) NOT NULL AUTO_INCREMENT,
  `nombres` text NOT NULL,
  `apellidos` text NOT NULL,
  `usuario` text NOT NULL,
  `contrase√±a` varchar(200) NOT NULL,
  `estado` int(11) NOT NULL,
  `fecha_creacion` text NOT NULL,
  `usuario_creacion` text NOT NULL,
  `fecha_modificacion` text DEFAULT NULL,
  `usuario_modificacion` text DEFAULT NULL,
  PRIMARY KEY (`id_usuario`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `mae_cliente` (
  `id_cliente` int(11) NOT NULL AUTO_INCREMENT,
  `id_usuario` int(11) DEFAULT NULL,
  `nombres` text NOT NULL,
  `apellidos` text NOT NULL,
  `razon_social` text NOT NULL,
  `dni_ruc` text NOT NULL,
  `direccion` text DEFAULT NULL,
  `telefono` text DEFAULT NULL,
  `email` text DEFAULT NULL,
  `estado` int(11) NOT NULL DEFAULT 1,
  `tipo_doc` varchar(10) NOT NULL DEFAULT 'DNI',
  PRIMARY KEY (`id_cliente`),
  KEY `id_usuario` (`id_usuario`),
  CONSTRAINT `mae_cliente_ibfk_1` FOREIGN KEY (`id_usuario`) REFERENCES `mae_usuario` (`id_usuario`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `mae_moneda` (
  `id_moneda` int(11) NOT NULL,
  `nombre_moneda` text NOT NULL,
  `simbolo` text NOT NULL,
  `cambio_actual` double NOT NULL,
  `fecha_actualizacion` text NOT NULL,
  `subunidad` text NOT NULL,
  PRIMARY KEY (`id_moneda`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `mae_producto` (
  `id_producto` int(11) NOT NULL AUTO_INCREMENT,
  `id_usuario` int(11) NOT NULL,
  `nombre` text NOT NULL,
  `descripcion` text DEFAULT NULL,
  `precio_unitario` double NOT NULL,
  `stock` int(11) NOT NULL,
  `estado` int(11) NOT NULL,
  PRIMARY KEY (`id_producto`),
  KEY `id_usuario` (`id_usuario`),
  CONSTRAINT `mae_producto_ibfk_1` FOREIGN KEY (`id_usuario`) REFERENCES `mae_usuario` (`id_usuario`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `mae_vendedor` (
  `id_vendedor` int(11) NOT NULL AUTO_INCREMENT,
  `id_usuario` int(11) NOT NULL,
  `nombre_vendedor` text NOT NULL,
  `apellido_vendedor` text NOT NULL,
  `celular` text NOT NULL,
  `correo` text NOT NULL,
  `estado` int(11) NOT NULL DEFAULT 1,
  PRIMARY KEY (`id_vendedor`),
  KEY `id_usuario` (`id_usuario`),
  CONSTRAINT `mae_vendedor_ibfk_1` FOREIGN KEY (`id_usuario`) REFERENCES `mae_usuario` (`id_usuario`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `trs_venta` (
  `id_venta` int(11) NOT NULL AUTO_INCREMENT,
  `id_vendedor` int(11) NOT NULL,
  `id_cliente` int(11) NOT NULL,
  `id_usuario` int(11) NOT NULL,
  `id_moneda` int(11) NOT NULL,
  `simbolo_moneda` text DEFAULT NULL,
  `fecha_venta` text NOT NULL,
  `total` double NOT NULL,
  `estado` int(11) NOT NULL,
  PRIMARY KEY (`id_venta`),
  KEY `id_vendedor` (`id_vendedor`),
  KEY `id_cliente` (`id_cliente`),
  KEY `id_usuario` (`id_usuario`),
  KEY `trs_venta_ibfk_4` (`id_moneda`),
  CONSTRAINT `trs_venta_ibfk_1` FOREIGN KEY (`id_vendedor`) REFERENCES `mae_vendedor` (`id_vendedor`),
  CONSTRAINT `trs_venta_ibfk_2` FOREIGN KEY (`id_cliente`) REFERENCES `mae_cliente` (`id_cliente`),
  CONSTRAINT `trs_venta_ibfk_3` FOREIGN KEY (`id_usuario`) REFERENCES `mae_usuario` (`id_usuario`),
  CONSTRAINT `trs_venta_ibfk_4` FOREIGN KEY (`id_moneda`) REFERENCES `mae_moneda` (`id_moneda`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `trs_factura` (
  `id_factura` int(11) NOT NULL AUTO_INCREMENT,
  `id_venta` int(11) NOT NULL,
  `id_usuario` int(11) NOT NULL,
  `id_moneda` int(11) NOT NULL,
  `tipo_comprobante` int(11) NOT NULL,
  `serie` text NOT NULL,
  `numero` int(11) NOT NULL,
  `fecha_emision` text NOT NULL,
  `monto_total` double NOT NULL,
  `subtotal` double DEFAULT NULL,
  `igv` double DEFAULT NULL,
  `estado` int(11) NOT NULL,
  PRIMARY KEY (`id_factura`),
  KEY `id_venta` (`id_venta`),
  KEY `id_usuario` (`id_usuario`),
  KEY `id_moneda` (`id_moneda`),
  CONSTRAINT `trs_factura_ibfk_1` FOREIGN KEY (`id_venta`) REFERENCES `trs_venta` (`id_venta`),
  CONSTRAINT `trs_factura_ibfk_2` FOREIGN KEY (`id_usuario`) REFERENCES `mae_usuario` (`id_usuario`),
  CONSTRAINT `trs_factura_ibfk_3` FOREIGN KEY (`id_moneda`) REFERENCES `mae_moneda` (`id_moneda`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `trs_cobranza` (
  `id_cobranza` int(11) NOT NULL AUTO_INCREMENT,
  `id_factura` int(11) NOT NULL,
  `id_cliente` int(11) NOT NULL,
  `id_usuario` int(11) DEFAULT NULL,
  `fecha_pago` text NOT NULL,
  `monto_pago` double NOT NULL,
  `estado` int(11) NOT NULL,
  PRIMARY KEY (`id_cobranza`),
  KEY `id_factura` (`id_factura`),
  KEY `id_cliente` (`id_cliente`),
  KEY `id_usuario` (`id_usuario`),
  CONSTRAINT `trs_cobranza_ibfk_1` FOREIGN KEY (`id_factura`) REFERENCES `trs_factura` (`id_factura`),
  CONSTRAINT `trs_cobranza_ibfk_2` FOREIGN KEY (`id_cliente`) REFERENCES `mae_cliente` (`id_cliente`),
  CONSTRAINT `trs_cobranza_ibfk_3` FOREIGN KEY (`id_usuario`) REFERENCES `mae_usuario` (`id_usuario`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `trs_detalle_venta` (
  `id_detalle` int(11) NOT NULL AUTO_INCREMENT,
  `id_venta` int(11) NOT NULL,
  `id_producto` int(11) NOT NULL,
  `cantidad` int(11) NOT NULL,
  `precio_unitario` double NOT NULL,
  `subtotal` double NOT NULL,
  PRIMARY KEY (`id_detalle`),
  KEY `id_venta` (`id_venta`),
  KEY `id_producto` (`id_producto`),
  CONSTRAINT `trs_detalle_venta_ibfk_1` FOREIGN KEY (`id_venta`) REFERENCES `trs_venta` (`id_venta`),
  CONSTRAINT `trs_detalle_venta_ibfk_2` FOREIGN KEY (`id_producto`) REFERENCES `mae_producto` (`id_producto`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
